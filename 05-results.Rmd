
# Results
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(GGally)
library(gridExtra)
library(here)
library(highcharter)
library(MASS)
library(parcoords)
library(plotly)
library(readr)
library(scales)
library(stringr)
library(tidyverse)
library(usdata)
library(statebins)
library(usmap)
library(dplyr)
library(socviz)
library(ggrepel)
library(ggthemes)
library(grid)
library(lubridate)
library(tidytext)
#library(devtools)
#devtools::install_github("lchiffon/wordcloud2")
library(wordcloud2)
library(jsonlite)
library(RColorBrewer)
```

## Related Factors

### Overview (by all factors)

### Most Relevant

### Least Relevant



## General Life Ladder Trend

### Trend by Time

### Trend by Geo

### Trend by Development Level



## COVID-19 Impact
```{r}
ave1719 <- read.csv("17_19_sample.csv")
averaged <- ave1719 %>% group_by(Country.name)  %>% summarise(score_1719 = mean(Life.Ladder))

score_2020 <- read.csv("2020_sample.csv")

temp_col <- score_2020$Life.Ladder[match(averaged$Country.name, score_2020$Country.name)]
averaged$score_2020 <- temp_col

averaged$difference <- ifelse(!is.na(averaged$score_2020), averaged$score_2020-averaged$score_1719, NA)

averaged <- averaged %>% arrange(desc(averaged$difference))
averaged <- subset(averaged, !is.na(averaged$difference))
```
### Comparison between Time (Pre and Post Pandemic)
We decide to use data averaged from 2017 to 2019 to represent the general life happiness score before the COVID-19 pandemic, and compare it to the 2020 happiness score. The difference between happiness score is the following:

```{r, fig.height=5}

theme_dotplot <- theme_bw(14) +
    theme(axis.text.y = element_text(size = rel(.75)),
        axis.ticks.y = element_blank(),
        axis.title.x = element_text(size = rel(.75)),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(size = 0.5),
        panel.grid.minor.x = element_blank())

ggplot(averaged, aes(x = difference, y = reorder(Country.name, difference)))+
    geom_point(color = "light blue") +
    xlab("Happiness Score Difference") +
    theme_dotplot +
    ylab("Country Name") +
    ggtitle("Happiness Score Difference by Post-Pre Pandemic")
```

```{r}

colors = c("firebrick2","white","dodgerblue3")

averaged <- averaged %>% select(Country.name, difference)

highchart() %>%
  hc_title(text = "Happiness Score Difference World Map") %>%
  hc_subtitle(text = "Double click on the state area to zoom in") %>%
  hc_add_series_map(worldgeojson, averaged,
    name = "Difference",
    value = "difference", joinBy = c("name", "Country.name"),
    dataLabels = list(
       enabled = TRUE,
       format = "{point.properties.name}"
     )) %>%
  hc_legend(title = 'Happiness Score Difference')%>%
  hc_colorAxis(min = -1, max = 1.1,
                stops = color_stops(n=3, colors=colors))%>%
  hc_mapNavigation(enabled = TRUE) %>%
  hc_legend(title = list(text = "Score Difference"),
              enabled = TRUE) %>% 
  hc_exporting(enabled = TRUE)

   
```

### Comparison between Geo

### Comparison between Development Level